---
title: Custom Platform and Headless Subscription Implementation
source: https://developer.ordergroove.com/docs/integrating-with-a-custom-platform-1
converted_from: html
---

# Custom Platform and Headless Subscription Implementation

## Ordergroove 101

*   [Developer Fundamentals](/docs/developer-fundamentals)
    *   [Systems Landscape Map](/docs/landscape-map)
    *   [Data model at a glance](/docs/data-model-at-a-glance)
    *   [Subscription Creation via Purchase POST](/docs/subscription-creation-via-purchase-post)
    *   [Recurring Order Placement](/docs/recurring-order-placement)
    *   [Subscription Manager Tagging and Authentication](/docs/subscription-manager-tagging-and-authentication)
    *   [Customer and Payment Updates](/docs/customer-and-payment-updates)
*   [General FAQ](/docs/general-faq)
*   [Install Ordergroove on an Online Store 2.0 theme](/docs/use-ordergroove-with-online-store-20)
    *   [Installing Ordergroove with App Embed](/docs/installing-ordergroove-with-app-embed)
*   [Custom Platform and Headless Subscription Implementation](/docs/integrating-with-a-custom-platform-1)

## Program Migration

*   [Migrate my data to Ordergroove](/docs/program-migration)
*   [Self-serve migration guide](/docs/view-self-serve-migration-guide)
*   [Self-serve migration guide for Recharge](/docs/self-serve-migration-guide-for-recharge)
*   [Staged Migrations](/docs/staged-migrations)

## Syncing Ordergroove Data

*   [Sync Ordergroove Data into Internal Systems](/docs/sync-ordergroove-data-into-internal-systems)
*   [Sync Objects](/docs/implement-custom-data-pipelines)
    *   [Implement Custom Data Pipelines](/docs/implement-custom-data-pipelines)
    *   [Using Prebuilt Connectors](/docs/using-prebuilt-connectors)
    *   [SFTP File Drops](/docs/sftp-file-drops)
*   [Sync Events](/docs/sync-events)

## Product Catalog

*   [Offer Tagging](/docs/offer-tagging)
*   [Product Feed](/docs/integrating-with-a-custom-platform)

## Subscription Enrollment

*   [Getting started](/docs/getting-started)
*   [First Order Place Date control for Shopify Merchants](/docs/first-order-place-date-control-for-shopify-merchants)
*   [Showing Discounted Price](/docs/showing-discounted-price-in-shopify)
*   [Customizing the Initial Offer Incentive (IOI)](/docs/customizing-the-initial-offer-incentive-ioi-using-shopify-scripts)
*   [Free shipping on initial orders](/docs/free-shipping-on-initial-orders-with-shopify-scripts)
*   [Cart Opt-In Tagging](/docs/shopify-cart-opt-in-tagging)
*   [Tagging the Product Details Page (PDP)](/docs/tagging-the-product-details-page-pdp)
*   [Real Time Stock Update](/docs/real-time-stock-update)
*   [Add a subscription to cart](/docs/modify-a-subscription-from-checkout-flow)
    *   [Offer Code Elements](/docs/offer-code-elements)
    *   [Domain Objects](/docs/domain-objects)
    *   [Helper Methods](/docs/helper-methods)
*   [Add a subscription offer to quickview, homepage, or other areas of your site](/docs/quickview-offers)
    *   [Tracking Affiliate Codes on Recurring Orders](/docs/tracking-affiliate-codes-on-recurring-orders)
*   [Troubleshooting Cart Offers](/docs/troubleshooting-cart-offers)
*   [Modify a subscription from email and SMS](/docs/modify-a-subscription-from-email-and-sms)
*   [Advanced Offer Customizations & FAQ](/docs/advanced-offer-customizations-faq)

## Subscription Manager Overview

*   [Subscription Manager From The Customer's Perspective](/docs/getting-started-1)
*   [Tour of Subscription Manager v25](/docs/tour-of-subscription-manager-v25)
    *   [Intro to v25 for Developers transitioning from v0](/docs/intro-to-v25-for-developers-transitioning-from-v0)
    *   [Customizing calendars and dates in v25](/docs/customizing-calendars-and-dates-in-v25)
    *   [Understanding Subscription Manager Custom Elements](/docs/understanding-subscription-manager-custom-elements)
*   [Subscription Manager File Descriptions](/docs/subscription-manager-file-descriptions)
*   [Subscription Manager v0 Components & Containers](/docs/subscription-manager-components-containers)
    *   [Subscription Manager Templates](/docs/subscription-manager-templates)
    *   [Orders Unsent Section](/docs/orders-unsent-section)
        *   [Skip Order](/docs/skip-order)
        *   [Send Now](/docs/send-now)
        *   [Change Date](/docs/change-date)
    *   [Orders Processing Section](/docs/orders-processing-section)
    *   [Inactive Subscriptions Section](/docs/inactive-subscriptions-section)
*   [Customize your Subscription Manager templates without breaking tracking](/docs/sm-template-customization-tracking)
*   [Subscription Manager Templates Changelog](/docs/subscription-manager-templates-changelog)

## Subscription Manager Modifications

*   [Subscription Manager Development Overview](/docs/subscription-manager-overview)
    *   [Edit Code with the Advanced Editor](/docs/edit-code-with-the-advanced-editor)
    *   [Subscription Manager Theme Editor Overview](/docs/subscription-manager-theme-editor-overview)
    *   [Subscription Manager Development Guide](/docs/subscription-manager-development-guide)
    *   [Customizing Subscription Manager Sections on Shopify](/docs/customizing-subscription-manager-sections-on-shopify)
    *   [Refreshing data in the Subscription Manager](/docs/refreshing-data-in-the-subscription-manager)
    *   [Objects](/docs/objects)
    *   [Object Reference](/docs/object-reference)
    *   [Translations](/docs/translations)
    *   [Subscription Manager Local Development](/docs/subscription-manager-local-development)
    *   [Debugging with Redux](/docs/debugging-with-redux)
    *   [Working with dates in the Subscription Manager](/docs/working-with-dates-in-the-subscription-manager)
*   [Modify the Change Billing Process Button](/docs/modify-the-change-billing-process-button)
*   [Implementing Country & State Dropdown in Subscription Manager Themes](/docs/implementing-country-state-dropdown-in-subscription-manager-themes)
*   [Adding a Cancel Button to Modals](/docs/adding-a-cancel-button-to-modals)
*   [Limiting Future Dates in the Change Date Calendar](/docs/limiting-future-dates-in-the-change-date-calendar)
*   [Dynamic Shipping Restrictions in the Subscription Manager](/docs/dynamic-shipping-restrictions-in-the-subscription-manager)
*   [One Time SKU Swap Configuration in the Subscription Manager](/docs/one-time-sku-swap-configuration-in-the-subscription-manager)
*   [Adding a Scrollbar to Inactive Subscriptions in the Subscription Manager](/docs/adding-a-scrollbar-to-inactive-subscriptions-in-the-subscription-manager)
*   [Enabling Payment Updates for Shopify New Accounts](/docs/enabling-payment-updates-for-shopify-new-accounts)

## Subscription Manager Development with APIs

*   [Calling Ordergroove’s REST APIs from within Subscription Manager](/docs/call-rest-apis-from-within-subscription-manager)
*   [Integrating External APIs in the Subscription Manager](/docs/integrating-external-apis-in-the-subscription-manager)

## Tagging Subscription Manager

*   [Tagging the Subscription Manager](/docs/tagging-the-subscription-manager-on-shopify)
*   [Convert your customers/account page to support Online Store 2.0](/docs/convert-your-customersaccount-page-to-support-online-store-20)

## Upsell and 1-Click

*   [Instant Upsell Overview](/docs/getting-started-2)
    *   [Instant Upsell through API](/docs/add-a-one-time-item-to-an-upcoming-order)
*   [1-Click Actions in Emails](/docs/1-click-actions-in-emails)

## Subscription Types

*   [Bundle Subscriptions](/docs/bundle-subscriptions)
    *   [Configuring Bundles](/docs/configuring-bundles)
    *   [Box Subscription Creation on Shopify](/docs/box-subscription-creation-on-shopify)
    *   [Bundle API Components](/docs/bundle-api-components)
    *   [Build Your Own Box Subscriptions (Legacy)](/docs/build-your-own-box-subscriptions)
        *   [Shopify - Build Your Own Box Subscriptions (Legacy)](/docs/build-your-own-box-subscriptions-on-shopify)
*   [Guided Selling](/docs/guided-selling)
*   [Curation Subscriptions: Rotating Box or Club](/docs/curation-subscriptions-rotating-box-or-club)
*   [Prepaid Subscriptions](/docs/how-to-manage-prepaid-renewal-behaviors)
    *   [How to Manage Prepaid Renewal Behaviors](/docs/how-to-manage-prepaid-renewal-behaviors)
*   [Rotating Subscriptions](/docs/rotating-subscriptions)
    *   [Ordinal Based Rotating Products](/docs/ordinal-based-rotating-products)
    *   [Time Window Based Rotating Products](/docs/time-window-based-rotating-products)
*   [Digital Subscriptions](/docs/digital-subscriptions)

## program data

*   [Configuring PayPal](/docs/configuring-paypal)
*   [Removing Ordergroove code from your Shopify theme](/docs/removing-ordergroove-code-from-your-shopify-theme)
*   [Webhooks overview (Legacy)](/docs/via-webhooks)
    *   [Configure Webhooks via API](/docs/configure-webhooks-via-api)
    *   [Expiring or Termed Subscriptions Using Webhooks](/docs/expiring-or-termed-subscriptions-using-webhooks)
*   [HMAC and AES Authentication](/docs/hmac-and-aes-authentication)

# Custom Platform and Headless Subscription Implementation

[Suggest Edits](/edit/integrating-with-a-custom-platform-1)

When using Ordergroove’s offers in a headless environment, you’ll need to read the subscription selections the customer is making throughout their purchase journey and set those selections within the cart the customer will be completing checkout through.

* * *

## 

Requirements

[](#requirements)

Follow the [standard tagging instructions](/docs/offer-tagging) for your e-commerce site as outlined in the [integration guide](https://help.ordergroove.com/hc/en-us/categories/4406847471507-Installing-Ordergroove). Be sure to tag your cart platform as well.

* * *

## 

Examples

[](#examples)

When a customer opts in to a subscription on a page and they then add that item to the cart, you can read the frequency and subscription opt in state by using the following javascript.

JavaScript

`const getFrequency = ({ form }) => {   const ogOffer = form.querySelector("og-offer");   if (!ogOffer) {     return null;   }   const subscribed = ogOffer.getAttribute("subscribed");   if (subscribed === null) {     return null;   }    return ogOffer.getAttribute("frequency"); };`

When you write the items from your headless page to where your cart is hosted, you’ll want to be sure to create a local storage object called OG\_STATE on your cart page. Make sure to make updates to this object any time a customer makes changes between the headless platform and the cart platform.

* * *

## 

OG STATE Object

[](#og-state-object)

OG State ObjectSample with Data

`OG_STATE: {   "sessionId":"(session id)", // generated during initial customer visit and doesn't need to change on page refresh   "optedin":[ // List of all products that a customer opts into during their visit prior to checkout     {        "id":"(product variant id)",        "frequency":"(every)_(every_period)"     },     {        "id":"(product variant id)",        "frequency":"(every)_(every_period)"     }   ],   "productOffer":{     "(product variant id)":["(offer id)"],     "(product variant id)":["(offer id)"]   } }` 

`OG_STATE: {   "sessionId":"15fc1b98803211ea8a5abc764e10b970.12345.1596647632",   "optedin":[         {         "id":"17300125089851",         "frequency":"1_3"         }   ],   "productOffer":{       "17307510177851":[         "160f5f5a803211eaaef3bc764e10b970"       ]   } }`

* * *

## 

Frequency Mapping

[](#frequency-mapping)

Frequency Every: ex: 1,2,3, etc  
Frequency Period: ex: 1 = days, 2 = weeks, 3 = months

* * *

## 

Purchase POST (with Subscription Verification)

[](#purchase-post-with-subscription-verification)

The Purchase POST will include an additional field ("processed") to mark the subscription as pending verification. This will hold the subscription in a pending state until you have the final notification that it is complete. The API should be used when the field "processed" is included in the subscription creation POST with a value of 'false'.

A value of 'true' in this field indicates that the subscription should be created right away, and should also be used for non-subscription checkouts.

A value of 'false' indicates that the verification is pending and the subscription will not be created until the subscription has been verified. To verify a subscription–and thereby allow its creation–the "processed" field must be set to 'true' through the use of this API.

The Purchase POST requires the use of the Content-type and Authorization headers.

`create_request={   "merchant_id": "<MERCHANT_ID>",   "session_id": "<SESSION_ID>",   "processed": true/false,         // true = create subscription now (also use this for non-subscription checkouts when og_autoship=0), false = fraud check pending   "merchant_order_id": "abc23124123",   "user": {     "user_id": "7654321",     "first_name": "Jane",     "last_name": "Rouse",     "email": "[[email protected]](/cdn-cgi/l/email-protection)",     "shipping_address": {       "first_name": "Jane",       "last_name": "Rouse",       "company_name": "OrderGroove",        // Optional       "address": "75 Broad Street",       "address2": "23rd Floor",             // Optional       "city": "New York",       "state_province_code": "NY",       "zip_postal_code": "10004",       "phone": "555-555-5555",       "fax": "",                            // Optional       "country_code": "US"                  // Must be two characters maximum     }   },   "payment": {                                          // Optional if customer is not subscibing to Auto-Replenish or opting in to SMS.     "token_id": "7654321",                              // Customer ID in Stripe. Optional     "cc_exp_date": "<AES_ENCRYPTED_CC_EXP_DATE>",     // Must be two digits for the month, a slash, and four-digits for year, e.g. 01/2019 | AES encrypted, then URL encoded     "cc_type": "1"                                      // The credit card type is 1 = Visa, 2 = MasterCard, 3 = American Express, 4 = Discover   },   "products": [     {       "product": "123456789",       "sku": "123456789",       "purchase_info": {         "quantity": 2,         "price": "2.00",         "discounted_price": "1.90",         "total": "3.80"       }     }   ] }`

### 

Subscription Verification

[](#subscription-verification)

This API should be used when the field "processed" is included in the subscription creation POST with a value of false. A value of true in this field indicates that the subscription should be created right away, or that there were no subscription items in the customer's cart.

A value of false indicates that the verification is pending and the subscription will not be created until the subscription has been verified. To verify a subscription–and thereby allow its creation–the "processed" field must be set to true through the use of this API.

**Destination**  
Staging: [https://staging.sc.ordergroove.com/subscription/verify](https://staging.sc.ordergroove.com/subscription/verify)  
Production: [https://sc.ordergroove.com/subscription/verify](https://sc.ordergroove.com/subscription/verify)

**Request Type**  
GET or POST

**Request Structure (HMAC) -**  
/subscription/verify/?merchant\_id=<MERCHANT\_ID>&order\_id=<MERCHANT\_ORDER\_ID>&ts=&sig=<ORDER\_ID\_SIGNATURE>

*   domain - which environment you are sending the request to
*   action - the action to take on the CloudSubscription. Must be one of the following values:
*   process - create the subscription
*   decline - do not create the subscription
*   order\_id - the merchant\_order\_id sent in the original subscription creation request
*   ts - timestamp
*   sig - Merchant generated signature for the combination of order\_id and ts, URL encoded

**Possible HTTP Responses**

Response Code 200:

*   SUCCESS
*   subscription request with merchant\_order\_id does not exist
*   subscription request with merchant\_order\_id has already been transmitted - This subscription request was already sent to our servers
*   Invalid Merchant - The merchant id provided does not exist

Response Code 400:

*   order id is required - a merchant order id was not passed in
*   Authentication failed
*   Invalid Merchant <MERCHANT\_ID>
*   Merchant ID must be string
*   Invalid action - an action other than the ones described above was supplied (not process/decline)

* * *

## 

Order Verification

[](#order-verification)

If you also need more time to receive order notification and a final status when OG submits future orders via API, then you can implement Order Verification as described below.

This API should be used in conjunction with the 010 error response code that is returned during order placement. The 010 error response code indicates the order has been created and is currently processing. While you verify the order, OrderGroove will hold the order in the processing state. Once the order has been processed via this API, the order will enter a final status in the OG system and notification will be sent to the customer if set up under the requirements of the integration.

Your initial response when we place an order via API should look like the following:

Sample Error Response

`<?xml version="1.0" encoding="UTF-8"?> <order>     <code>SUCCESS</code>     <responseCode>010</responseCode>     <orderId>1224</orderId> </order>`

**Destination**

*   Staging: [https://staging.v2.ordergroove.com/order/verify](https://staging.v2.ordergroove.com/order/verify)
*   Production: [https://api.ordergroove.com/order/verify](https://api.ordergroove.com/order/verify)

**Request Type**

*   POST

**Request Variables**

*   merchant\_id - string - public ID of the merchant
*   orders - Array of JSON objects
    *   order\_id - string - the order ID that was originally provided to OrderGroove at order placement
    *   status - string - updated status of the order
        *   000 — success
        *   010 — created and processing
        *   020 — invalid, order not created
        *   030 — canceled
        *   100 — invalid credit card type
        *   110 — invalid credit card number
        *   120 — invalid credit card expiration date
        *   130 — invalid billing address
        *   140 — payment declined
        *   999 — order processing issue – retry later
    *   messge - string - optional message supporting/describing the provided status
    *   **Example**: \[{"order\_id": "123", "status": "000", "message": "success"}, {"order\_id": "345", "status": "140", "message": "Payment declined"}\]
*   **Full Example**: {"merchant\_id":"<merchant\_id>","orders":\[{"order\_id": "123", "status": "000", "message": "success"}, {"order\_id": "345", "status": "140", "message": "Payment declined"}\]}

**Response**

The response will be a JSON object consisting of:

*   status - string - defines the overall result status of the request
    *   000 - complete success
    *   001 - partial success
    *   002 - fatal error
*   order\_id - string - the order ID that was originally provided to OrderGroove at order placement
    *   result - string - "success"/"error"
    *   message - string - optional message supporting/describing the provided result status
    *   **Example**: \[{"order\_id": "123", "result": "success"}, {"order\_id": "345", "result": "error", "message": "Order does not exist"}\]
*   **Example**:
    *   {"status": "000", "orders": \[{...}\] }
    *   {"status": "001", "orders": \[{...}\] }
    *   {"status": "002", "error\_object":{...}}

In the event of a "002" (fatal error) response, there will be no "orders" key, but instead an "error\_object" key that will consist of another JSON object, giving more details about the system failure. This error will be emailed to OrderGroove administrators at the time it occurs, so that they can begin assessing the source of the system error.

**Error Messages**

The following are the list of possible messages to be seen when an "error" result is provided in the response

*   "Order does not exist"
*   "Unknown status code provided"
*   "Order not in 'Processing' status"

Updated 5 months ago

* * *

*   [Table of Contents](#)
*   *   [Requirements](#requirements)
    *   [Examples](#examples)
    *   [OG STATE Object](#og-state-object)
    *   [Frequency Mapping](#frequency-mapping)
    *   [Purchase POST (with Subscription Verification)](#purchase-post-with-subscription-verification)
        *   [Subscription Verification](#subscription-verification)
    *   [Order Verification](#order-verification)
