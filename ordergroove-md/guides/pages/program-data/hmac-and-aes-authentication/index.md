---
title: HMAC and AES Authentication
source: https://developer.ordergroove.com/docs/hmac-and-aes-authentication
converted_from: html
---

# HMAC and AES Authentication

## Ordergroove 101

*   [Developer Fundamentals](/docs/developer-fundamentals)
    *   [Systems Landscape Map](/docs/landscape-map)
    *   [Data model at a glance](/docs/data-model-at-a-glance)
    *   [Subscription Creation via Purchase POST](/docs/subscription-creation-via-purchase-post)
    *   [Recurring Order Placement](/docs/recurring-order-placement)
    *   [Subscription Manager Tagging and Authentication](/docs/subscription-manager-tagging-and-authentication)
    *   [Customer and Payment Updates](/docs/customer-and-payment-updates)
*   [General FAQ](/docs/general-faq)
*   [Install Ordergroove on an Online Store 2.0 theme](/docs/use-ordergroove-with-online-store-20)
    *   [Installing Ordergroove with App Embed](/docs/installing-ordergroove-with-app-embed)
*   [Custom Platform and Headless Subscription Implementation](/docs/integrating-with-a-custom-platform-1)

## Program Migration

*   [Migrate my data to Ordergroove](/docs/program-migration)
*   [Self-serve migration guide](/docs/view-self-serve-migration-guide)
*   [Self-serve migration guide for Recharge](/docs/self-serve-migration-guide-for-recharge)
*   [Staged Migrations](/docs/staged-migrations)

## Syncing Ordergroove Data

*   [Sync Ordergroove Data into Internal Systems](/docs/sync-ordergroove-data-into-internal-systems)
*   [Sync Objects](/docs/implement-custom-data-pipelines)
    *   [Implement Custom Data Pipelines](/docs/implement-custom-data-pipelines)
    *   [Using Prebuilt Connectors](/docs/using-prebuilt-connectors)
    *   [SFTP File Drops](/docs/sftp-file-drops)
*   [Sync Events](/docs/sync-events)

## Product Catalog

*   [Offer Tagging](/docs/offer-tagging)
*   [Product Feed](/docs/integrating-with-a-custom-platform)

## Subscription Enrollment

*   [Getting started](/docs/getting-started)
*   [First Order Place Date control for Shopify Merchants](/docs/first-order-place-date-control-for-shopify-merchants)
*   [Showing Discounted Price](/docs/showing-discounted-price-in-shopify)
*   [Customizing the Initial Offer Incentive (IOI)](/docs/customizing-the-initial-offer-incentive-ioi-using-shopify-scripts)
*   [Free shipping on initial orders](/docs/free-shipping-on-initial-orders-with-shopify-scripts)
*   [Cart Opt-In Tagging](/docs/shopify-cart-opt-in-tagging)
*   [Tagging the Product Details Page (PDP)](/docs/tagging-the-product-details-page-pdp)
*   [Real Time Stock Update](/docs/real-time-stock-update)
*   [Add a subscription to cart](/docs/modify-a-subscription-from-checkout-flow)
    *   [Offer Code Elements](/docs/offer-code-elements)
    *   [Domain Objects](/docs/domain-objects)
    *   [Helper Methods](/docs/helper-methods)
*   [Add a subscription offer to quickview, homepage, or other areas of your site](/docs/quickview-offers)
    *   [Tracking Affiliate Codes on Recurring Orders](/docs/tracking-affiliate-codes-on-recurring-orders)
*   [Troubleshooting Cart Offers](/docs/troubleshooting-cart-offers)
*   [Modify a subscription from email and SMS](/docs/modify-a-subscription-from-email-and-sms)
*   [Advanced Offer Customizations & FAQ](/docs/advanced-offer-customizations-faq)

## Subscription Manager Overview

*   [Subscription Manager From The Customer's Perspective](/docs/getting-started-1)
*   [Tour of Subscription Manager v25](/docs/tour-of-subscription-manager-v25)
    *   [Intro to v25 for Developers transitioning from v0](/docs/intro-to-v25-for-developers-transitioning-from-v0)
    *   [Customizing calendars and dates in v25](/docs/customizing-calendars-and-dates-in-v25)
    *   [Understanding Subscription Manager Custom Elements](/docs/understanding-subscription-manager-custom-elements)
*   [Subscription Manager File Descriptions](/docs/subscription-manager-file-descriptions)
*   [Subscription Manager v0 Components & Containers](/docs/subscription-manager-components-containers)
    *   [Subscription Manager Templates](/docs/subscription-manager-templates)
    *   [Orders Unsent Section](/docs/orders-unsent-section)
        *   [Skip Order](/docs/skip-order)
        *   [Send Now](/docs/send-now)
        *   [Change Date](/docs/change-date)
    *   [Orders Processing Section](/docs/orders-processing-section)
    *   [Inactive Subscriptions Section](/docs/inactive-subscriptions-section)
*   [Customize your Subscription Manager templates without breaking tracking](/docs/sm-template-customization-tracking)
*   [Subscription Manager Templates Changelog](/docs/subscription-manager-templates-changelog)

## Subscription Manager Modifications

*   [Subscription Manager Development Overview](/docs/subscription-manager-overview)
    *   [Edit Code with the Advanced Editor](/docs/edit-code-with-the-advanced-editor)
    *   [Subscription Manager Theme Editor Overview](/docs/subscription-manager-theme-editor-overview)
    *   [Subscription Manager Development Guide](/docs/subscription-manager-development-guide)
    *   [Customizing Subscription Manager Sections on Shopify](/docs/customizing-subscription-manager-sections-on-shopify)
    *   [Refreshing data in the Subscription Manager](/docs/refreshing-data-in-the-subscription-manager)
    *   [Objects](/docs/objects)
    *   [Object Reference](/docs/object-reference)
    *   [Translations](/docs/translations)
    *   [Subscription Manager Local Development](/docs/subscription-manager-local-development)
    *   [Debugging with Redux](/docs/debugging-with-redux)
    *   [Working with dates in the Subscription Manager](/docs/working-with-dates-in-the-subscription-manager)
*   [Modify the Change Billing Process Button](/docs/modify-the-change-billing-process-button)
*   [Implementing Country & State Dropdown in Subscription Manager Themes](/docs/implementing-country-state-dropdown-in-subscription-manager-themes)
*   [Adding a Cancel Button to Modals](/docs/adding-a-cancel-button-to-modals)
*   [Limiting Future Dates in the Change Date Calendar](/docs/limiting-future-dates-in-the-change-date-calendar)
*   [Dynamic Shipping Restrictions in the Subscription Manager](/docs/dynamic-shipping-restrictions-in-the-subscription-manager)
*   [One Time SKU Swap Configuration in the Subscription Manager](/docs/one-time-sku-swap-configuration-in-the-subscription-manager)
*   [Adding a Scrollbar to Inactive Subscriptions in the Subscription Manager](/docs/adding-a-scrollbar-to-inactive-subscriptions-in-the-subscription-manager)
*   [Enabling Payment Updates for Shopify New Accounts](/docs/enabling-payment-updates-for-shopify-new-accounts)

## Subscription Manager Development with APIs

*   [Calling Ordergrooveâ€™s REST APIs from within Subscription Manager](/docs/call-rest-apis-from-within-subscription-manager)
*   [Integrating External APIs in the Subscription Manager](/docs/integrating-external-apis-in-the-subscription-manager)

## Tagging Subscription Manager

*   [Tagging the Subscription Manager](/docs/tagging-the-subscription-manager-on-shopify)
*   [Convert your customers/account page to support Online Store 2.0](/docs/convert-your-customersaccount-page-to-support-online-store-20)

## Upsell and 1-Click

*   [Instant Upsell Overview](/docs/getting-started-2)
    *   [Instant Upsell through API](/docs/add-a-one-time-item-to-an-upcoming-order)
*   [1-Click Actions in Emails](/docs/1-click-actions-in-emails)

## Subscription Types

*   [Bundle Subscriptions](/docs/bundle-subscriptions)
    *   [Configuring Bundles](/docs/configuring-bundles)
    *   [Box Subscription Creation on Shopify](/docs/box-subscription-creation-on-shopify)
    *   [Bundle API Components](/docs/bundle-api-components)
    *   [Build Your Own Box Subscriptions (Legacy)](/docs/build-your-own-box-subscriptions)
        *   [Shopify - Build Your Own Box Subscriptions (Legacy)](/docs/build-your-own-box-subscriptions-on-shopify)
*   [Guided Selling](/docs/guided-selling)
*   [Curation Subscriptions: Rotating Box or Club](/docs/curation-subscriptions-rotating-box-or-club)
*   [Prepaid Subscriptions](/docs/how-to-manage-prepaid-renewal-behaviors)
    *   [How to Manage Prepaid Renewal Behaviors](/docs/how-to-manage-prepaid-renewal-behaviors)
*   [Rotating Subscriptions](/docs/rotating-subscriptions)
    *   [Ordinal Based Rotating Products](/docs/ordinal-based-rotating-products)
    *   [Time Window Based Rotating Products](/docs/time-window-based-rotating-products)
*   [Digital Subscriptions](/docs/digital-subscriptions)

## program data

*   [Configuring PayPal](/docs/configuring-paypal)
*   [Removing Ordergroove code from your Shopify theme](/docs/removing-ordergroove-code-from-your-shopify-theme)
*   [Webhooks overview (Legacy)](/docs/via-webhooks)
    *   [Configure Webhooks via API](/docs/configure-webhooks-via-api)
    *   [Expiring or Termed Subscriptions Using Webhooks](/docs/expiring-or-termed-subscriptions-using-webhooks)
*   [HMAC and AES Authentication](/docs/hmac-and-aes-authentication)

# HMAC and AES Authentication

[Suggest Edits](/edit/hmac-and-aes-authentication)

The following article outlines the details for HMAC authentication and AES encryption. HMAC authentication is used for authenticating API calls as well as authenticating logged-in users to view their subscriptions within the My Account section of your site. Please refer to the specific documentation flow to determine how this authentication is used (for example, API header, cookie, etc). AES encryption is typically used solely for encrypting the credit card expiration date when that data is passed to and from Ordergroove via API.

* * *

## 

HMAC Authentication

[](#hmac-authentication)

Item

Definition

RAW\_DATA\_POINT

One data point used as the input for the signature generation function. For the purpose of this integration, this will always be the user ID.

SECONDS\_SINCE\_EPOCH

The Unix epoch (or Unix time, POSIX time or Unix timestamp) is the number of seconds that have elapsed since January 1, 1970 (midnight UTC/GMT). This will be a 10-digit number.

SHA-256

The hash function set as a parameter of the HMAC signature generation function.

HASH\_KEY

Secret hash key provided to you by your Ordergroove team, unique to your merchant.

The signature is created in the following way:

Using the HMAC hash function, generate a signature using SHA-256. The function input also includes the concatenation of RAW\_DATA\_POINT and SECONDS\_SINCE\_EPOCH (see definition above) with a pipe character in between, and the secret hash key.

If you are sending the signature in an HTTP request, you must URL encode it before sending.

Example:

HTML

`signature=hash_hmac("sha256","<RAW_DATA_POINT>|<SECONDS_SINCE_EPOCH>","<HASH_KEY>");`

### 

The HMAC Signature Tool

[](#the-hmac-signature-tool)

The HMAC Generator tool contains a form with which you can create a valid HMAC signature. This tool is most often helpful to confirm that your integration is correctly generating the signature that Ordergroove is anticipating.

If you have permissions to use this tool, youâ€™ll find this utility within Ordergroove under [Developers > HMAC Generator](https://rc3.ordergroove.com/tools/hmac_generator/). If you would like to request access to the HMAC Signature Tool, please reach out to Ordergroove support.

### 

Using the Tool

[](#using-the-tool)

In the **Unique Identifier** field, enter the customer ID from your e-commerce platform. If no hash key is entered, Ordergroove will use the merchant-level hash key configured for your account in the Ordergroove environment in which you are using the utility.

Finally, the timestamp will automatically generate with the current 10-digit Unix timestamp but can be updated to match the one used in your test request.

When using an HMAC signature for API requests and setting the og\_auth cookie, Ordergroove requires that the timestamp is within the last two hours.

![](https://files.readme.io/aea0f6d-Screen_Shot_2022-09-27_at_2.33.17_PM.png)

* * *

## 

AES Encryption

[](#aes-encryption)

Item

Description

Algorithm

AES

Mode

ECB

Padding

Right-padded with '{' characters

Block-size

32 bytes

First, with the hash key, generate an **AES** cipher using **ECB** mode. ie: cipher - AES.new(hash\_key)

To encode data:

1.  Pad the data you want to encode with the "{" character so that it is a multiple of 32 characters in length.
    1.  Pseduo code example: (data + (32 - length(data) modulus 32) \* "{" )
    2.  If data="something" the result of padding data would be "something{{{{{{{{{{{{{{{{{{{{{{{"
2.  Encrypt the padded data with the cipher
    1.  Pseudo code example: cipher.encrypt(padded\_data)

To decode data:

1.  Decrypt with the cipher
    1.  Pseudo code example: cipher.decrypt()
2.  Remove all the padding characters
    1.  Pseudo code example: decrypted\_data.rstrip("{")

Examples:

PHPPython

`<?php  class Example { const CYPHER = MCRYPT_RIJNDAEL_128; const MODE = MCRYPT_MODE_ECB; const BLOCK_SIZE = 32; const PADDING = '{'; protected $_hashKey = null; public function setHashKey($data) { $this->_hashKey = $data; } public function getHexHashKey() { return pack('H*', bin2hex($this->_hashKey)); }  public function pad($data) { $data . str_repeat(self::PADDING,(self::BLOCK_SIZE - (strlen($data) % self::BLOCK_SIZE))); } public function strip($data) { return str_replace(self::PADDING, '', $data); } public function encrypt($data) { return trim(base64_encode(mcrypt_encrypt(self::CYPHER, $this->getHexHashKey(), $data, self::MODE))); } public function decrypt($data) { return $this->strip(mcrypt_decrypt(self::CYPHER,$this->getHexHashKey(),base64_decode($data),self::MODE)); } } $obj = new Example; $obj->setHashKey('Mt!ZQ45q&GHsgiRD8{NB-_h87#rjvbn0'); $ccNumber = '4111111111111111'; echo "Original credit card number: $ccNumber<BR>"; $encryptedCcNumber = $obj->encrypt($ccNumber); echo "Encrypted credit card number: $encryptedCcNumber<BR>"; $unencryptedCcNumber = $obj->decrypt($encryptedCcNumber); echo "Unencrypted credit card number: $unencryptedCcNumber";`

`BLOCK_SIZE = 32 PADDING = '{'   def pad(s):     return s + (BLOCK_SIZE - len(s) % BLOCK_SIZE) * PADDING   def EncodeAES(c, s):     return base64.b64encode(c.encrypt(pad(s)))   def DecodeAES(c, e):     return c.decrypt(base64.b64decode(e)).rstrip(PADDING)   hash_key = 'Mt!ZQ45q&GHsgiRD8{NB-_h87#rjvbn0' cipher = AES.new(hash_key)  encoded = EncodeAES(cipher, "something") something = DecodeAES(cipher, encoded)`

Updated 6 months ago

* * *

*   [Table of Contents](#)
*   *   [HMAC Authentication](#hmac-authentication)
        *   [The HMAC Signature Tool](#the-hmac-signature-tool)
        *   [Using the Tool](#using-the-tool)
    *   [AES Encryption](#aes-encryption)
